<project name="libRemoteServices" default="dist" basedir=".">
	<description>
        Genera el jar con RemoteClient y sus dependencias
    </description>
	<!-- set global properties for this build -->
	<property name="src" location="src" />
	<property name="build" location="bin" />
	<property name="src-test" location="test" />
	<property name="build-test" location="bin-test" />
	<property name="dist" location="dist" />
	<property name="lib" location="lib" />
	<property name="andamiJar" location="../_fwAndami/andami.jar" />
	<property name="andamiLibs" location="../_fwAndami/lib" />
	<property name="fmapLibs" location="../libFMap" />
	<property name="jarName" value="remote-clients" />
	<property name="targetDir" location="../libFMap/lib" />
	<!--<property name="compile-classpath" value="${andamiJar}:${fmapLibs}/lib/driver-manager-1.0.jar:${andamiLibs}/lib/tempFileManager.jar:${lib}/kxml2.jar" />-->
	<import file="../binaries/ant/utilities.xml"/>

	<target name="init">
		<!-- Create the time stamp -->
		<tstamp />
		<echo>
			Compiling ${ant.project.name}...</echo>
		<!-- Create the build directory structure used by compile -->
		<mkdir dir="${build}" />
	</target>

	<target name="dist" depends="init" description="generate the distribution">
		<!-- Create the distribution directory -->
		<mkdir dir="${dist}" />

		<!-- Put everything in ${build} into the cms-${DSTAMP}.jar file -->
		<jar jarfile="${dist}/${jarName}.jar" basedir="${build}" />
		<jar jarfile="${dist}/${jarName}.jar" basedir="." includes="images/*.gif" update="true" />

		<move todir="${targetDir}/">
			<fileset dir="${dist}" includes="**/**" />
		</move>
		<copy todir="${targetDir}/">
			<fileset dir="${lib}" includes="*.jar" />
		</copy>
	</target>

	<target		name="batch-build"
				description="compile the sources, create the jar file"
				depends="init,compile,create-jar,move-to-fmap">
	</target>

	<target name="compile" description="compile the source">
		<!-- Compile the Java code from ${src} to ${build} -->
		<mkdir dir="${build}" />
		<loadEclipseClasspath project="${basedir}"/>
		<gvSIG-javac
			classpath="${eclipseClasspath}"/>
	</target>

	<target name="move-to-fmap" description="Move jars and required libraries to fmap">
		<copy todir="${targetDir}">
			<fileset dir="./lib" includes="*.jar" />
		</copy>
		<copy todir=".">
			<fileset dir="${dist}" includes="${jarName}.jar" />
		</copy>
		<move todir="${targetDir}/">
			<fileset dir="${dist}" includes="**/**" />
		</move>
	</target>

	<target name="create-jar" description="Crea el jar de la aplicacion">
		<mkdir dir="${dist}" />
		<jar jarfile="${dist}/${jarName}.jar" basedir="${build}" />
		<jar jarfile="${dist}/${jarName}.jar" basedir="." includes="images/*" update="true" />
	</target>

	<target name="clean" description="clean up">
		<!-- Delete the ${build} and ${dist} directory trees -->
		<delete dir="${build}" />
		<delete dir="${dist}" />
	</target>

	<target name="run-tests" depends="batch-build,compile-tests">
		<antcall target="generic-run-tests">
			<param name="TestSuite.Name" value="org.gvsig.remoteClient.AllTests"/>
		</antcall>
	</target>
</project>

